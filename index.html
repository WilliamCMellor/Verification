<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mellor Collection COA Verification</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Playfair Display', serif;
            background-color: #0D0D0D;
            color: #F5F5F5;
            text-align: center;
            padding: 50px;
        }
        h2 {
            font-family: 'Cinzel', serif;
            font-size: 2.5em;
            color: #E6B800;
            text-transform: uppercase;
        }
        select, button, input {
            margin: 10px;
            padding: 10px;
            font-size: 1em;
            border: 2px solid #E6B800;
            background: black;
            color: white;
        }
        select:hover, button:hover, input:hover {
            background: #E6B800;
            color: black;
        }
        #qrcode {
            margin-top: 20px;
        }
        #result {
            font-size: 1.5em;
            margin-top: 20px;
        }
        #details {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            margin-top: 20px;
            border-radius: 10px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script>
        const collections = {
            "collection1": {
                hash: "HASH_FOR_COLLECTION1",
                name: "Mellor Collection - Mini 1",
                owners: "John Doe, Jane Smith",
                report: "<a href='https://your-site.com/report1.pdf' target='_blank'>Mellor Heritage & Provenance Report</a>"
            },
            "collection2": {
                hash: "HASH_FOR_COLLECTION2",
                name: "Mellor Collection - Mini 2",
                owners: "Alice Brown, Robert Johnson",
                report: "<a href='https://your-site.com/report2.pdf' target='_blank'>Mellor Heritage & Provenance Report</a>"
            }
        };
        
        async function verifyFile() {
            const fileInput = document.getElementById('fileInput');
            const resultDiv = document.getElementById('result');
            const detailsDiv = document.getElementById('details');
            
            if (fileInput.files.length === 0) {
                resultDiv.innerText = "Please upload a COA PDF.";
                return;
            }
            
            const file = fileInput.files[0];
            const arrayBuffer = await file.arrayBuffer();
            const hashBuffer = await crypto.subtle.digest('SHA-256', arrayBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            
            let verifiedCollection = null;
            for (const key in collections) {
                if (collections[key].hash === hashHex) {
                    verifiedCollection = collections[key];
                    break;
                }
            }
            
            if (verifiedCollection) {
                resultDiv.innerText = "✅ COA is authentic!";
                resultDiv.style.color = "#E6B800";
                detailsDiv.innerHTML = `<h3>${verifiedCollection.name}</h3>
                                       <p><strong>Previous Owners:</strong> ${verifiedCollection.owners}</p>
                                       <p><strong>Provenance Report:</strong> ${verifiedCollection.report}</p>`;
            } else {
                resultDiv.innerText = "❌ COA verification failed!";
                resultDiv.style.color = "red";
                detailsDiv.innerHTML = "";
            }
        }
        
        function generateQRCode(collectionId) {
            const qrDiv = document.getElementById('qrcode');
            qrDiv.innerHTML = "";
            const url = window.location.href + `?collection=${collectionId}`;
            new QRCode(qrDiv, url);
        }
    </script>
</head>
<body>
    <h2>Mellor Collection COA Verification</h2>
    <p>Select a mini-collection to generate a QR code:</p>
    <select onchange="generateQRCode(this.value)">
        <option value="">-- Select Collection --</option>
        <option value="collection1">Mellor Collection - Mini 1</option>
        <option value="collection2">Mellor Collection - Mini 2</option>
    </select>
    <div id="qrcode"></div>
    
    <h3>Upload COA to Verify</h3>
    <input type="file" id="fileInput" accept="application/pdf">
    <button onclick="verifyFile()">Verify COA</button>
    <p id="result"></p>
    <div id="details"></div>
</body>
</html>
